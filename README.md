# Modular MOTD Health System

A state-driven system health framework designed for instant, non-blocking operator awareness via MOTD or `.bashrc`.

## üéØ Aim & Objectives
This project solves the "Laggy Login" problem on busy Linux servers (like Proxmox or high-density ZFS hosts). Traditional MOTD scripts run heavy diagnostics *during* the login process, causing delays. 

**Objectives:**
* **Zero-Latency Login:** Health checks are pre-computed in the background; logins merely read a static state file.
* **Binary Tick-List:** Quickly identify which subsystem (Storage, Network, Fleet) needs attention without reading logs.
* **Actionable Escalation:** If a check fails, the MOTD provides the exact command needed to investigate.
* **State Isolation:** A failure in one check script cannot hang the renderer or the login process.

---

## üõ†Ô∏è Installation (The Setup Script)
The easiest way to deploy the system is using the automated setup script. It handles directory creation, permissions, systemd orchestration, and `.bashrc` integration.

```bash
git clone <your-repo-url>
cd motd-health
sudo chmod +x system-setup.sh
sudo ./system-setup.sh

```

### Manual Installation

If you prefer to move files manually:

1. **Scripts**: Move `checks/` to `/usr/local/lib/motd-health/`.
2. **Renderer**: Move `bin/render-motd.sh` to `/usr/local/bin/`.
3. **Persistence**: Move `systemd/motd-health.*` to `/etc/systemd/system/`.
4. **Activation**: Run `systemctl enable --now motd-health.timer`.
5. **Integration**: Append the contents of `examples/bashrc-snippet.txt` to your `~/.bashrc`.

---

## üèóÔ∏è Architecture

* **Checks (`checks/`)**: Independent bash scripts that monitor specific system pillars.
* **State (`/run/motd-health/`)**: Transient POSIX-safe state files generated by checks.
* **Renderer (`bin/render-motd.sh`)**: A non-privileged script that reads state and displays health.
* **Systemd**: Orchestrates checks via timers (default: 1-minute intervals) to ensure state is fresh.

---

## üöÄ Daily Usage & Support

Once installed, your MOTD will look like a "Health Dashboard."

* **[ PASS ]**: Everything is nominal.
* **[ WARN ]**: Subsystem is degraded (e.g., updates pending or high memory).
* **[ FAIL ]**: Immediate action required (e.g., ZFS Pool Degraded).

**Adding a New Pillar:**

1. Create `checks/check-<name>.sh`.
2. Ensure it outputs to `/run/motd-health/<name>.state` following the `STATUS/SUMMARY/REMEDIATE` format.
3. The `system-setup.sh` will automatically pick up any new scripts in the `checks/` folder during the next run.

---

## üñãÔ∏è Credits

Designed by **John McCrudden** and aided by **LLM (Large Language Model)** to architect and optimize the code.

---

## üìÑ License

This project is open-source. Feel free to fork, refactor, and improve.
